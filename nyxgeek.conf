# NYXGEEK'S CUSTOM RULES
# 2015-08-12     nyxgeek@rslabs.co
# Remember: you have to specify --encoding for these to work!
#  --encoding=iso-8859-2 or  --encoding=utf8 etc
# These aren't elegantly written, but they work.



# These are apparently the most popular UTF chars posted to 
# john-contest mailing list by Royce. I found them via 
# https://github.com/AlbertVeli/pwtools/blob/master/permute.c
# I removed a number of the regular ASCII ones from the beginning

[List.Rules:MostPopularUTF]
<* >\r[00123456789] A\p[z0-9]"\xc2\xa3"
<* >\r[00123456789] A\p[z0-9]"\xc2\xa4"
<* >\r[00123456789] A\p[z0-9]"\xc2\xa7"
<* >\r[00123456789] A\p[z0-9]"\xc2\xb1"
<* >\r[00123456789] A\p[z0-9]"\xc2\xb3"
<* >\r[00123456789] A\p[z0-9]"\xc2\xb9"
<* >\r[00123456789] A\p[z0-9]"\xc2\xba"
<* >\r[00123456789] A\p[z0-9]"\xc2\xbf"
<* >\r[00123456789] A\p[z0-9]"\xc3\x82"
<* >\r[00123456789] A\p[z0-9]"\xc3\x83"
<* >\r[00123456789] A\p[z0-9]"\xc3\x84"
<* >\r[00123456789] A\p[z0-9]"\xc3\x90"
<* >\r[00123456789] A\p[z0-9]"\xc3\x91"
<* >\r[00123456789] A\p[z0-9]"\xc3\x94"
<* >\r[00123456789] A\p[z0-9]"\xc3\x97"
<* >\r[00123456789] A\p[z0-9]"\xc3\x98"
<* >\r[00123456789] A\p[z0-9]"\xc3\x99"
<* >\r[00123456789] A\p[z0-9]"\xc3\x9f"
<* >\r[00123456789] A\p[z0-9]"\xc3\xa0"
<* >\r[00123456789] A\p[z0-9]"\xc3\xa1"
<* >\r[00123456789] A\p[z0-9]"\xc3\xa2"
<* >\r[00123456789] A\p[z0-9]"\xc3\xa3"
<* >\r[00123456789] A\p[z0-9]"\xc3\xa4"
<* >\r[00123456789] A\p[z0-9]"\xc3\xa5"
<* >\r[00123456789] A\p[z0-9]"\xc3\xa6"
<* >\r[00123456789] A\p[z0-9]"\xc3\xa7"
<* >\r[00123456789] A\p[z0-9]"\xc3\xa8"
<* >\r[00123456789] A\p[z0-9]"\xc3\xa9"
<* >\r[00123456789] A\p[z0-9]"\xc3\xaa"
<* >\r[00123456789] A\p[z0-9]"\xc3\xab"
<* >\r[00123456789] A\p[z0-9]"\xc3\xac"
<* >\r[00123456789] A\p[z0-9]"\xc3\xad"
<* >\r[00123456789] A\p[z0-9]"\xc3\xae"
<* >\r[00123456789] A\p[z0-9]"\xc3\xaf"
<* >\r[00123456789] A\p[z0-9]"\xc3\xb0"
<* >\r[00123456789] A\p[z0-9]"\xc3\xb1"
<* >\r[00123456789] A\p[z0-9]"\xc3\xb2"
<* >\r[00123456789] A\p[z0-9]"\xc3\xb3"
<* >\r[00123456789] A\p[z0-9]"\xc3\xb4"
<* >\r[00123456789] A\p[z0-9]"\xc3\xb5"
<* >\r[00123456789] A\p[z0-9]"\xc3\xb6"
<* >\r[00123456789] A\p[z0-9]"\xc3\xb8"
<* >\r[00123456789] A\p[z0-9]"\xc3\xb9"
<* >\r[00123456789] A\p[z0-9]"\xc3\xba"
<* >\r[00123456789] A\p[z0-9]"\xc3\xbc"
<* >\r[00123456789] A\p[z0-9]"\xc3\xbd"
<* >\r[00123456789] A\p[z0-9]"\xc3\xbf"
<* >\r[00123456789] A\p[z0-9]"\xc5\x93"
<* >\r[00123456789] A\p[z0-9]"\xc5\xa1"
<* >\r[00123456789] A\p[z0-9]"\xc5\xbe"
<* >\r[00123456789] A\p[z0-9]"\xd0\x91"
<* >\r[00123456789] A\p[z0-9]"\xd0\x92"
<* >\r[00123456789] A\p[z0-9]"\xd0\x93"
<* >\r[00123456789] A\p[z0-9]"\xd0\x94"
<* >\r[00123456789] A\p[z0-9]"\xd0\x97"
<* >\r[00123456789] A\p[z0-9]"\xd0\x98"
<* >\r[00123456789] A\p[z0-9]"\xd0\x9a"
<* >\r[00123456789] A\p[z0-9]"\xd0\x9b"
<* >\r[00123456789] A\p[z0-9]"\xd0\x9c"
<* >\r[00123456789] A\p[z0-9]"\xd0\x9d"
<* >\r[00123456789] A\p[z0-9]"\xd0\x9e"
<* >\r[00123456789] A\p[z0-9]"\xd0\x9f"
<* >\r[00123456789] A\p[z0-9]"\xd0\xad"
<* >\r[00123456789] A\p[z0-9]"\xd0\xaf"
<* >\r[00123456789] A\p[z0-9]"\xd0\xb0"
<* >\r[00123456789] A\p[z0-9]"\xd0\xb1"
<* >\r[00123456789] A\p[z0-9]"\xd0\xb2"
<* >\r[00123456789] A\p[z0-9]"\xd0\xb3"
<* >\r[00123456789] A\p[z0-9]"\xd0\xb4"
<* >\r[00123456789] A\p[z0-9]"\xd0\xb5"
<* >\r[00123456789] A\p[z0-9]"\xd0\xb6"
<* >\r[00123456789] A\p[z0-9]"\xd0\xb7"
<* >\r[00123456789] A\p[z0-9]"\xd0\xb8"
<* >\r[00123456789] A\p[z0-9]"\xd0\xb9"
<* >\r[00123456789] A\p[z0-9]"\xd0\xba"
<* >\r[00123456789] A\p[z0-9]"\xd0\xbb"
<* >\r[00123456789] A\p[z0-9]"\xd0\xbc"
<* >\r[00123456789] A\p[z0-9]"\xd0\xbd"
<* >\r[00123456789] A\p[z0-9]"\xd0\xbe"
<* >\r[00123456789] A\p[z0-9]"\xd0\xbf"
<* >\r[00123456789] A\p[z0-9]"\xd1\x80"
<* >\r[00123456789] A\p[z0-9]"\xd1\x81"
<* >\r[00123456789] A\p[z0-9]"\xd1\x82"
<* >\r[00123456789] A\p[z0-9]"\xd1\x83"
<* >\r[00123456789] A\p[z0-9]"\xd1\x85"
<* >\r[00123456789] A\p[z0-9]"\xd1\x86"
<* >\r[00123456789] A\p[z0-9]"\xd1\x87"
<* >\r[00123456789] A\p[z0-9]"\xd1\x88"
<* >\r[00123456789] A\p[z0-9]"\xd1\x8b"
<* >\r[00123456789] A\p[z0-9]"\xd1\x8c"
<* >\r[00123456789] A\p[z0-9]"\xd1\x8d"
<* >\r[00123456789] A\p[z0-9]"\xd1\x8e"
<* >\r[00123456789] A\p[z0-9]"\xd1\x8f"
<* >\r[00123456789] A\p[z0-9]"\xd8\xa3"
<* >\r[00123456789] A\p[z0-9]"\xd8\xa5"
<* >\r[00123456789] A\p[z0-9]"\xd8\xa6"
<* >\r[00123456789] A\p[z0-9]"\xd8\xa7"
<* >\r[00123456789] A\p[z0-9]"\xd8\xa8"
<* >\r[00123456789] A\p[z0-9]"\xd8\xa9"
<* >\r[00123456789] A\p[z0-9]"\xd8\xaa"
<* >\r[00123456789] A\p[z0-9]"\xd8\xab"
<* >\r[00123456789] A\p[z0-9]"\xd8\xac"
<* >\r[00123456789] A\p[z0-9]"\xd8\xad"
<* >\r[00123456789] A\p[z0-9]"\xd8\xae"
<* >\r[00123456789] A\p[z0-9]"\xd8\xaf"
<* >\r[00123456789] A\p[z0-9]"\xd8\xb1"
<* >\r[00123456789] A\p[z0-9]"\xd8\xb2"
<* >\r[00123456789] A\p[z0-9]"\xd8\xb3"
<* >\r[00123456789] A\p[z0-9]"\xd8\xb4"
<* >\r[00123456789] A\p[z0-9]"\xd8\xb5"
<* >\r[00123456789] A\p[z0-9]"\xd8\xb6"
<* >\r[00123456789] A\p[z0-9]"\xd8\xb7"
<* >\r[00123456789] A\p[z0-9]"\xd8\xb8"
<* >\r[00123456789] A\p[z0-9]"\xd8\xb9"
<* >\r[00123456789] A\p[z0-9]"\xd8\xba"
<* >\r[00123456789] A\p[z0-9]"\xd9\x81"
<* >\r[00123456789] A\p[z0-9]"\xd9\x82"
<* >\r[00123456789] A\p[z0-9]"\xd9\x83"
<* >\r[00123456789] A\p[z0-9]"\xd9\x84"
<* >\r[00123456789] A\p[z0-9]"\xd9\x85"
<* >\r[00123456789] A\p[z0-9]"\xd9\x86"
<* >\r[00123456789] A\p[z0-9]"\xd9\x87"
<* >\r[00123456789] A\p[z0-9]"\xd9\x88"
<* >\r[00123456789] A\p[z0-9]"\xd9\x89"
<* >\r[00123456789] A\p[z0-9]"\xd9\x8a"
<* >\r[00123456789] A\p[z0-9]"\xd9\xa0"
<* >\r[00123456789] A\p[z0-9]"\xd9\xa1"
<* >\r[00123456789] A\p[z0-9]"\xd9\xa2"
<* >\r[00123456789] A\p[z0-9]"\xd9\xa3"
<* >\r[00123456789] A\p[z0-9]"\xd9\xa4"
<* >\r[00123456789] A\p[z0-9]"\xd9\xa5"
<* >\r[00123456789] A\p[z0-9]"\xd9\xa6"
<* >\r[00123456789] A\p[z0-9]"\xd9\xa7"
<* >\r[00123456789] A\p[z0-9]"\xd9\xa8"
<* >\r[00123456789] A\p[z0-9]"\xd9\xa9"
<* >\r[00123456789] A\p[z0-9]"\xd9\xab"
<* >\r[00123456789] A\p[z0-9]"\xdb\xb1"
<* >\r[00123456789] A\p[z0-9]"\xdb\xb3"
<* >\r[00123456789] A\p[z0-9]"\xdb\xb5"
<* >\r[00123456789] A\p[z0-9]"\x04\x4F"



[List.Rules:AddASCIIEverywhere]
# this is a rip-off of KL's version, same results but cleaner
-[c:] >4 <- \p[c:] i[0-5][0-9a-zA-Z!$ @#%.^&()_+\-={}|[\]\\;'":,/<>?`~*]
-[c:] >[5-8] <- \p1[c:] i\p2[6-9][0-9a-zA-Z!$ @#%.^&()_+\-={}|[\]\\;'":,/<>?`~*]




[List.Rules:AddUTF8Everywhere]
# These are my original rules, just going through A0-FF range
# It adds a UTF8 character at all char positions

<* >\r[00123456789] A\p[z0-9]"\xA0"
<* >\r[00123456789] A\p[z0-9]"\xA1"
<* >\r[00123456789] A\p[z0-9]"\xA2"
<* >\r[00123456789] A\p[z0-9]"\xA3"
<* >\r[00123456789] A\p[z0-9]"\xA4"
<* >\r[00123456789] A\p[z0-9]"\xA5"
<* >\r[00123456789] A\p[z0-9]"\xA6"
<* >\r[00123456789] A\p[z0-9]"\xA7"
<* >\r[00123456789] A\p[z0-9]"\xA8"
<* >\r[00123456789] A\p[z0-9]"\xA9"
<* >\r[00123456789] A\p[z0-9]"\xAA"
<* >\r[00123456789] A\p[z0-9]"\xAB"
<* >\r[00123456789] A\p[z0-9]"\xAC"
<* >\r[00123456789] A\p[z0-9]"\xAD"
<* >\r[00123456789] A\p[z0-9]"\xAE"
<* >\r[00123456789] A\p[z0-9]"\xAF"

<* >\r[00123456789] A\p[z0-9]"\xB0"
<* >\r[00123456789] A\p[z0-9]"\xB1"
<* >\r[00123456789] A\p[z0-9]"\xB2"
<* >\r[00123456789] A\p[z0-9]"\xB3"
<* >\r[00123456789] A\p[z0-9]"\xB4"
<* >\r[00123456789] A\p[z0-9]"\xB5"
<* >\r[00123456789] A\p[z0-9]"\xB6"
<* >\r[00123456789] A\p[z0-9]"\xB7"
<* >\r[00123456789] A\p[z0-9]"\xB8"
<* >\r[00123456789] A\p[z0-9]"\xB9"
<* >\r[00123456789] A\p[z0-9]"\xBA"
<* >\r[00123456789] A\p[z0-9]"\xBB"
<* >\r[00123456789] A\p[z0-9]"\xBC"
<* >\r[00123456789] A\p[z0-9]"\xBD"
<* >\r[00123456789] A\p[z0-9]"\xBE"
<* >\r[00123456789] A\p[z0-9]"\xBF"

<* >\r[00123456789] A\p[z0-9]"\xC0"
<* >\r[00123456789] A\p[z0-9]"\xC1"
<* >\r[00123456789] A\p[z0-9]"\xC2"
<* >\r[00123456789] A\p[z0-9]"\xC3"
<* >\r[00123456789] A\p[z0-9]"\xC4"
<* >\r[00123456789] A\p[z0-9]"\xC5"
<* >\r[00123456789] A\p[z0-9]"\xC6"
<* >\r[00123456789] A\p[z0-9]"\xC7"
<* >\r[00123456789] A\p[z0-9]"\xC8"
<* >\r[00123456789] A\p[z0-9]"\xC9"
<* >\r[00123456789] A\p[z0-9]"\xCA"
<* >\r[00123456789] A\p[z0-9]"\xCB"
<* >\r[00123456789] A\p[z0-9]"\xCC"
<* >\r[00123456789] A\p[z0-9]"\xCD"
<* >\r[00123456789] A\p[z0-9]"\xCE"
<* >\r[00123456789] A\p[z0-9]"\xCF"

<* >\r[00123456789] A\p[z0-9]"\xD0"
<* >\r[00123456789] A\p[z0-9]"\xD1"
<* >\r[00123456789] A\p[z0-9]"\xD2"
<* >\r[00123456789] A\p[z0-9]"\xD3"
<* >\r[00123456789] A\p[z0-9]"\xD4"
<* >\r[00123456789] A\p[z0-9]"\xD5"
<* >\r[00123456789] A\p[z0-9]"\xD6"
<* >\r[00123456789] A\p[z0-9]"\xD7"
<* >\r[00123456789] A\p[z0-9]"\xD8"
<* >\r[00123456789] A\p[z0-9]"\xD9"
<* >\r[00123456789] A\p[z0-9]"\xDA"
<* >\r[00123456789] A\p[z0-9]"\xDB"
<* >\r[00123456789] A\p[z0-9]"\xDC"
<* >\r[00123456789] A\p[z0-9]"\xDD"
<* >\r[00123456789] A\p[z0-9]"\xDE"
<* >\r[00123456789] A\p[z0-9]"\xDF"

<* >\r[00123456789] A\p[z0-9]"\xE0"
<* >\r[00123456789] A\p[z0-9]"\xE1"
<* >\r[00123456789] A\p[z0-9]"\xE2"
<* >\r[00123456789] A\p[z0-9]"\xE3"
<* >\r[00123456789] A\p[z0-9]"\xE4"
<* >\r[00123456789] A\p[z0-9]"\xE5"
<* >\r[00123456789] A\p[z0-9]"\xE6"
<* >\r[00123456789] A\p[z0-9]"\xE7"
<* >\r[00123456789] A\p[z0-9]"\xE8"
<* >\r[00123456789] A\p[z0-9]"\xE9"
<* >\r[00123456789] A\p[z0-9]"\xEA"
<* >\r[00123456789] A\p[z0-9]"\xEB"
<* >\r[00123456789] A\p[z0-9]"\xEC"
<* >\r[00123456789] A\p[z0-9]"\xED"
<* >\r[00123456789] A\p[z0-9]"\xEE"
<* >\r[00123456789] A\p[z0-9]"\xEF"

<* >\r[00123456789] A\p[z0-9]"\xF0"
<* >\r[00123456789] A\p[z0-9]"\xF1"
<* >\r[00123456789] A\p[z0-9]"\xF2"
<* >\r[00123456789] A\p[z0-9]"\xF3"
<* >\r[00123456789] A\p[z0-9]"\xF4"
<* >\r[00123456789] A\p[z0-9]"\xF5"
<* >\r[00123456789] A\p[z0-9]"\xF6"
<* >\r[00123456789] A\p[z0-9]"\xF7"
<* >\r[00123456789] A\p[z0-9]"\xF8"
<* >\r[00123456789] A\p[z0-9]"\xF9"
<* >\r[00123456789] A\p[z0-9]"\xFA"
<* >\r[00123456789] A\p[z0-9]"\xFB"
<* >\r[00123456789] A\p[z0-9]"\xFC"
<* >\r[00123456789] A\p[z0-9]"\xFD"
<* >\r[00123456789] A\p[z0-9]"\xFE"
<* >\r[00123456789] A\p[z0-9]"\xFF"




[List.Rules:SwapCharactersExtended]
# I know this rule isn't pretty...
# run it and then toggle the first letter - this means that whatever it is
# whether it is capitalized or not, it will swap it
# Note: since it does toggle-case each, it takes 2x as long as if we don’t

#replace L's with £
/L sL\xA3 T0
/L sL\xA3
/l sl\xA3 T0
/l sl\xA3

#replace c's ¢
/C sC\xA2 T0
/C sC\xA2
/c sc\xA2 T0
/c sc\xA2

#replace a’s
/A sA\xC0 T0
/A sA\xC0
/A sA\xC1 T0
/A sA\xC1
/A sA\xC2 T0
/A sA\xC2
/A sA\xC3 T0
/A sA\xC3
/A sA\xC4 T0
/A sA\xC4
/A sA\xC5 T0
/A sA\xC5
/A sA\xC6 T0
/A sA\xC6
/a sa\xE0 T0
/a sa\xE0
/a sa\xE1 T0
/a sa\xE1
/a sa\xE2 T0
/a sa\xE2
/a sa\xE3 T0
/a sa\xE3
/a sa\xE4 T0
/a sa\xE4
/a sa\xE5 T0
/a sa\xE5
/a sa\xE6 T0
/a sa\xE6

#replace c’s
/C sC\xC7 T0
/C sC\xC7
/c sc\xE7 T0
/c sc\xE7

#replace e’s
/E sE\xC8 T0
/E sE\xC8
/E sE\xC9 T0
/E sE\xC9
/E sE\xCA T0
/E sE\xCA
/E sE\xCB T0
/E sE\xCB
/e se\xe8 T0
/e se\xe8
/e se\xe9 T0
/e se\xe9
/e se\xea T0
/e se\xea
/e se\xeb T0
/e se\xeb

#REPLACE i's
/I sI\xCC T0
/I sI\xCC
/I sI\xCD T0
/I sI\xCD
/I sI\xCE T0
/I sI\xCE
/I sI\xCF T0
/I sI\xCF
/i si\xEC T0
/i si\xEC
/i si\xED T0
/i si\xED
/i si\xEE T0
/i si\xEE
/i si\xEF T0
/i si\xEF

#replace n's
/N sN\xD1 T0
/N sN\xD1
/n sn\xF1 T0
/n sn\xF1

#replace o's
/O sO\xD2 T0
/O sO\xD2
/O sO\xD3 T0
/O sO\xD3
/O sO\xD4 T0
/O sO\xD4
/O sO\xD5 T0
/O sO\xD5
/O sO\xD6 T0
/O sO\xD6
/O sO\xD8 T0
/O sO\xD8
/o so\xF2 T0
/o so\xF2 
/o so\xF3 T0
/o so\xF3 
/o so\xF4 T0
/o so\xF4 
/o so\xF5 T0
/o so\xF5 
/o so\xF6 T0
/o so\xF6 
/o so\xF8 T0
/o so\xF8 

#replace u's
/U sU\xD9 T0
/U sU\xD9
/U sU\xDA T0
/U sU\xDA
/U sU\xDB T0
/U sU\xDB
/U sU\xDC T0
/U sU\xDC
/u su\xF9 T0
/u su\xF9
/u su\xFA T0
/u su\xFA
/u su\xFB T0
/u su\xFB
/u su\xFC T0
/u su\xFC

#replace y's
/Y sY\xDD T0
/Y sY\xDD
/Y sY\xA5 T0
/Y sY\xA5
/y sy\xFD T0
/y sy\xFD
/y sy\xFF T0
/y sy\xFF




#KoreLogic had add years rules but really it's the 2000s
#and the full gamut took forever to run
#prepend years 2000s, try lowercase and try toggling the first char
[List.Rules:PrependYears2000s]
A0"20[0-1][0-9]"
A0"20[0-1][0-9]" T0


## DOUBLE CHECK THIS - assumes they are lowercase atm
[List.Rules:AppendYears2000s]
-[c:] \p[c:] Az"20[01][0-9]" <+
-[c:] \p[c:] Az"20[01][0-9]" <+


# modifed directly from KL to add 2000s years everywhere
# only 2000-2099 though - we're not insane
[List.Rules:Add2000sEverywhere]
<* >\r[00123456789] A\p[z0-9]"20[0-9][0-9]"



#going back to our linkedin dump - THIS IS A CPU-COSTLY VERSION
[List.Rules:AddLinkedInEverywhere_FULL]
<* >\r[00123456789] A\p[z0-9]"[Ll\xA3][Ii!|1\xCC\xCD\xCE\xCF\xEC\xED\xEE\xEF][Nn\xD1\xF1\xA1][Kk][Ee3\xC8\xC9\xCA\xCB\xE8\xE9\xEA\xEB][Dd][Ii!|1\xCC\xCD\xCE\xCF\xEC\xED\xEE\xEF\xA1][Nn\xD1\xF1]"
<* >\r[00123456789] A\p[z0-9]"[Ll\xA3][Ii!|1\xCC\xCD\xCE\xCF\xEC\xED\xEE\xEF][Nn\xD1\xF1\xA1][Kk][Ee3\xC8\xC9\xCA\xCB\xE8\xE9\xEA\xEB][Dd]"


#going back to our linkedin dump - THIS IS THE SLIGHTLY FASTER VERSION
[List.Rules:AddLinkedInEverywhere_FAST]
<* >\r[00123456789] A\p[z0-9]"[Ll\xA3][Ii!1\xCC\xCD\xCE\xCF\xEC\xED\xEE\xEF][Nn\xD1\xF1\xA1][Kk][Ee3\xC8\xC9\xCA\xCB\xE8\xE9\xEA\xEB][Dd][Ii!1\xCC\xCD\xCE\xCF\xEC\xED\xEE\xEF\xA1][Nn\xD1\xF1]"



[List.Rules:AddPasswordEverywhere]
<* >\r[00123456789] A\p[z0-9]"[Pp][Aa\xC0\xC1\xC2\xC3\xC4\xC5\xE0\xE1\xE2\xE3\xE4\xE5][Ss$\xA7][Ss$\xA7][Ww][Oo\xD2\xD3\xD4\xD5\xD6\xD8\xF2\xF3\xF4\xF5\xF6\xF8][Rr\xAE][Dd\xD0\xF0]"


# Pretty sure this already exists in john.conf as part of single?
# delete a char at every position [0-9]
[List.Rules:RemoveCharacterEverywhere]
<* >\r[00123456789] D\p[z0-9]

